\section{Using RL for pixel affinity predictions}~\label{sec:rl_for_seg}

This project started with the idea of an RL setting where an agent manipulates affinities between pixel pairs. Those affinities formulate an input to the Mutex Wateshed algorithm (see section \ref{sec:mtx_wtsd}).\\
The edge set that the Mutex Watershed typically works with are short range attractive edges and long lange repulsive edges. That means that there should be exactly one attractive edge for every directly neighboring pair of pixels and some long range repulsive edges. Defining the problem by manipulating affinities leads to a hard task since there are simply too many.\\
RL methods learn by rewards resulting from actions and an initial state. To achieve convergence, initially there needs to be some rewards of a high value, that means that the actions taken lead to a fairly good segmentation. However when starting to learn a network from noise it outputs completely arbitrary actions that unlikely lead to a high reward because the action space is too large.\\
The RL-typical bootstrapping works only if there is a meaningful gradient in the reward signal, even for random actions. It is not uncommon in RL to have a large action space while the reward is a single scalar value. If it would be possible to calculate more meaningful rewards, say per subregion in the image, one could compute a RL loss term for each of those subregions only considering the actions that manipulated affinities within this region.\\

To downsize an image segmentation problem, it is common to work with superpixels \cite{10.1007/978-3-642-23094-3_3} rather than  with pixels. A superpixel segmentation or oversegmentation is usually achieved by watersheding or smoothing + clustering algorithms.
Using Mutex Watershed one can simply globally decrease the edge weights of the attractive edges in order to arrive at an oversegmentation.
Starting from such an oversegmentation and assuming that the ground-truth segmentation is a partitioning of the superpixels, focusing solely on merging and unmerging superpixels would be sufficient. Concerning the Mutex Watershed algorithm, a merge of two superpixels would be done by turning all the repulsive edges between them into attractive ones (multiplying their edge weight by $-1$) and vice versa for unmerging. Therefore one needs a decision/action for every neighboring pair of superpixels. However there are two problems with this.\\
First, only hard merges and unmerges of superpixels can be performed which likely leads to contradictions. For example consider 3 adjacent superpixels with 2 merges and 1 unmerge predicted. This is of course nothing Mutex Watershed cannot handle but the result is likely not a partitioning of the superpixels and therefore not in the intended set of possible results.\\
The second issue is, that for CNNs it is difficult to make predictions on affinities between adjacent superpixels due to the irregularity of the region adjacency graph of the superpixels.